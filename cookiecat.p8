pico-8 cartridge // http://www.pico-8.com
version 29
__lua__
--🐱
t = 0
bullets = {}
jumprefresh = true
mapcoordinates = {0,0}
function _init()
	cat = {
	x = 64,
	y = 64,
	dx = 0,
	dy = 0,
	running = false,
	shooting = false,
	isleft = false,
	runningmod = 0,
	grounded = true,
	jumping = false,
	shoottime = 0
	}
	t = 0
end

function _update()
	t+=1
	update_bullets()
	cat.x += cat.dx
	cat.y += cat.dy
	if fget(mget((cat.x+4)/8,(cat.y+8)/8),0) then
		cat.dy = 0
		cat.y = flr((cat.y)/8)*8
		cat.grounded = true
	else
		cat.grounded = false
	end
	if t %10 == 0 then
		if cat.runningmod == 1 then
			cat.runningmod = 0
		else
			cat.runningmod = 1
		end
	end
	if btn(⬅️) then
		if not cat.shooting then
			cat.isleft = true
		end
		cat.dx = -3
		--cat.isleft = true
		cat.running = true
	elseif btn(➡️) then
		if not cat.shooting then
			cat.isleft = false
		end
		cat.dx =3
		cat.running = true
	end
	if btnp(🅾️) and cat.grounded and jumprefresh then
		jumprefresh = false
		cat.grounded = false
		cat.jumping = true
		cat.dy = -9
	end
	if not btn(⬅️) and not btn(➡️) then
		cat.running = false
		if cat.dx > 0 then
			cat.dx -= .5
		end
		if cat.dx < 0 then
			cat.dx += .5
		end
	end
	if not btn(🅾️) then
		jumprefresh = true
	end
	
	if not cat.grounded and not cat.jumping then
		if cat.dy < 0 then
			cat.dy += 1
		else
			cat.dy += 2
		end
	end
	
	if cat.jumping and not cat.grounded then
		if btn(🅾️) and cat.dy < 0 then
			cat.dy += 1
		else
			cat.dy += 2
		end
	end
	
	if btnp(❎) then
		if not cat.shooting then
			cat.shooting = true
			catshoot()
			cat.shoottime = t
		end
	end
	
	if cat.shooting then
		if t - 10 >= cat.shoottime then
			cat.shooting = false
		end
	end
	
end

function catshoot()
	sfx(0)
	if cat.isleft then
		add(bullets,{x=cat.x, y = cat.y+5, dx= -3.5})
	else
		add(bullets,{x=cat.x+8,y=cat.y+5,dx=3.5})
	end
end

function _draw()
	cls()
	--rectfill(0,0,128,128,9)
	map()
	--`print(btnp(❎),1)
	if cat.shooting then
		if not cat.running then
			spr(1,cat.x,cat.y,1,1,cat.isleft)
		else
			spr(4+cat.runningmod,cat.x,cat.y,1,1,cat.isleft)
		end
	else
		if not cat.running then
			spr(6,cat.x,cat.y,1,1,cat.isleft)
		end 
		if cat.running then
			spr(2+cat.runningmod,cat.x,cat.y,1,1,cat.isleft)
		end
	end
	
	draw_bullets()
	
end

function update_bullets()
	foreach(bullets, function(bullet)
		if bullet.x > 0 and bullet.x < 128 then
			bullet.x += bullet.dx
		else
			del(bullets, bullet)
		end
	end)
end

function draw_bullets()
	foreach(bullets, function(bullet)
		if bullet.dx > 0 then
			rect(bullet.x,bullet.y,bullet.x+3,bullet.y,14)
		else
			rect(bullet.x,bullet.y,bullet.x-3,bullet.y,14)
		end
	end)
end
__gfx__
00000000666666006666660066666600666666006666660066666600000000000000000000000000000000000000000000000000000000000000000000000000
00000000616661606166616061666160616661606166616061666160000000000000000000000000000000000000000000000000000000000000000000000000
00700700611111606111116061111160611111606111116061111160000000000000000000000000000000000000000000000000000000000000000000000000
0007700061f11f6061f11f6061f11f6061f11f6061f11f6061f11f60000000000000000000000000000000000000000000000000000000000000000000000000
00077000611111606111116061111160611111606111116061111160000000000000000000000000000000000000000000000000000000000000000000000000
007007000eede5550eede0000eede0000eede5550eede5550eede000000000000000000000000000000000000000000000000000000000000000000000000000
000000001dd9d5000d19d0000d19d0000d19d5000d19d5001dd9d100000000000000000000000000000000000000000000000000000000000000000000000000
00000000010010000100010010001000010001001000100001001000000000000000000000000000000000000000000000000000000000000000000000000000
dd11dd11000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
dddddddd000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
dddddddd000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
d11ddddd000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
d11ddddd000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
dddddddd000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
dddddd1d000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
dddddddd000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__gff__
0000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__map__
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0707070707070707070707000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0707070707070707070707000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1010101010101010101010101000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000101010101000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000101010101000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000101010101000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__sfx__
000200003115029150231501d15016100181000010017100001000010000100001000010000100001000010000100001000010000100001000010000100001000010000100001000010000100001000010000100
__music__
00 00424344

