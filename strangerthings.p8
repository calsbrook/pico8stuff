pico-8 cartridge // http://www.pico-8.com
version 18
__lua__
function _init()
	player.character=1
	_upd=update_game
	_drw=draw_game
	dirx={-1,1,0,0}
	diry={0,0,-1,1}
	t=0
	startgame()
end

function _update()
	t+=1
	_upd()
end

function _draw()
	_drw()
end

function startgame()
	player.x=3
	player.y=10
end

player = {
	x=12,
	y=2,
	ox=0,
	oy=0,
	character=1,
	isleft=false,
	dustinlife=10,
	lucaslife=10,
	mikelife=10,
	elevenlife=10,
	mana=5
}
-->8
--update
function update_game()
	for i=0,3 do
		if btnp(i) then
			moveplayer(dirx[i+1],diry[i+1])
			
		 _upd=update_playerturn
		end
	end
	
	if btnp(üÖæÔ∏è)and player.character<4 then
		player.character+=1
		else if btnp(üÖæÔ∏è) then
			player.character=1
		end
	end
	if btnp(‚ùé) and player.character>1 then
		player.character-=1
		else if btnp(‚ùé) then
			player.character=4
		end
	end
end

function update_playerturn()
	
	if player.ox>0 then
		player.ox-=2
	end
	if player.ox<0 then
		player.ox+=2
	end
	if player.oy>0 then
	 player.oy-=2
	end
	if player.oy<0 then
		player.oy+=2
	end
	if player.ox==0 and player.oy==0 then
		_upd=update_game
	end
end

function update_gameover()

end
-->8
--draw

function draw_game()
	cls()
	map()
	spr(player.character+(flr(t/6)%2*16),player.x*8+player.ox,player.y*8+player.oy,1,1,player.isleft)
	rectfill( 26*(player.character-1),0,26*(player.character-1)+20,5,13)
	print("du:"..player.dustinlife,0,0,9)
	print("lu:"..player.lucaslife,26,0)
	print("mi:"..player.mikelife,26*2,0)
	print("el:"..player.elevenlife,26*3,0)
	print("mana:"..player.mana,26*4,0,12)
end

function draw_gameover()

end
-->8
--tools
function getframe(_ani,_num)
	return ani[flr(t/6)%num*16]
end

function drawspr(_spr,_x,_y,_c)
	palt(0,false)
	pal(6,_c)
	spr(_spr,_x*8,_y*8)
	pal()
end

function moveplayer(dx,dy)
	local tile=mget(player.x+dx,player.y+dy)
	if dx>0 then
		player.isleft=false
	elseif dx<0 then
		player.isleft=true
	end
	if fget(tile,0) then
		player.ox=dx*4
		player.oy=dy*4
	else
		player.x+=dx
	 player.y+=dy
	 player.ox+=-dx*8
	 player.oy+=-dy*8
	end
	
	if fget(tile,1) then
		triggerbump(tile,player.x+dx,player.y+dy)
	end
end

function triggerbump(tile,destx,desty)
		if tile==74 or tile==75 then
			--vases
			mset(destx,desty,65)
		elseif tile==69 then
			--doors
			mset(destx,desty,65)
		elseif tile==70 or tile==71 then
			--chests
			mset(destx,desty,tile+2)
		end
end
-->8


__gfx__
00000000008777700001110000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000008777700011111000111111000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00700700008888880011111001111111044444400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00077000044ffff00033333001fffff104fffff00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0007700004fcffc00141441001f1ff1004f1ff100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0070070000fffff00044444001fffff004fffff00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000033330000cccc0000aaaa0000eeee000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000007007000070070000700700007007000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000008777700001110000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000008777700011111000111111000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000008888880011111001111111044444400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000044ffff00033333001fffff104fffff00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000004fcffc00141441001f1ff1004f1ff100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000fffff00044444001fffff004fffff00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000007007000070070000700700007007000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
60666060000000009999999010000000000000019099909000999000000000000000000000000000009990000099900000000000000000000000000000000000
0000000000000000000000001011000000001101000000009099909009999990ddddddd00dddddd0090009000900090000000000000000000000000000000000
6660666000000000990000001011011001101101909990909000009009000090d00000d00d0000d0090009000900090000000000000000000000000000000000
0000000000000000990990000011011001101100009990009009009009099090d00000d00d0000d0909990900099900000000000000000000000000000000000
6066606000000000990990901000011001100001909990909990999009999990ddddddd00dddddd0990099900900990000000000000000000000000000000000
00000000001000009909909010110000000011010099900000000000000000000000000000000000099999000999990000000000000000000000000000000000
6660666000000000990990901011011001101101909990909999999009999990ddddddd00dddddd0009990000099900000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
88888888888888888888888888888888888888888888888888888888888888880000000000000000000000000000000000000000000000000000000000000000
80000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
88888888888888888888888888888888888888888888888888888888888888880000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00008888888888080888888888888888880888888888888888800000008880000000000000000000000000000000000000000000000000000000000000000000
00880000000000880800000000000000080080000000000000080000000800000000000000000000000000000000000000000000000000000000000000000000
08000000888800080800088000088000080008000008888000008000000800000000000000000000000000000000000000000000000000000000000000000000
08000008000080080808808000080880080008000008000800008000000800000000000000000000000000000000000000000000000000000000000000000000
80000080000008080880008000080008880008000008000800008000008080000000000000000000000000000000000000000000000000000000000000000000
80000080000000880800008000080000080008000008000800080000008080000000000000000000000000000000000000000000000000000000000000000000
80000008000000080000008000080000000008000008008000080000008080000000000000000000000000000000000000000000000000000000000000000000
80000000800000000000008000080000000008000008080000800000080800000000000000000000000000000000000000000000000000000000000000000000
80000000088000000000008000080000000008000008800008000000080800000000000000000000000000000000000000000000000000000000000000000000
08000000000880000000008000080000000008000000000008000000080880000000000000000000000000000000000000000000000000000000000000000000
08000000000008800000008000080000000008000000880000800000800000000000000000000000000000000000000000000000000000000000000000000000
00800000000000080000008000080000000008000008008000800000808880000000000000000000000000000000000000000000000000000000000000000000
00088000000000008000008000080000000008000008008000080000808000000000000000000000000000000000000000000000000000000000000000000000
00000880000000000800008000080000000008000008000800080008080000000000000000000000000000000000000000000000000000000000000000000000
00000008800000000800008000080000000008000008000800008008080000000000000000000000000000000000000000000000000000000000000000000000
00000000088000000080008000080000000008000008000080008008080000000000000000000000000000000000000000000000000000000000000000000000
80000000000800000080008000080000000008000008000080000880800000000000000000000000000000000000000000000000000000000000000000000000
80000000000080000080080000008000000080000000800080000000800000000000000000000000000000000000000000000000000000000000000000000000
88000000000080000080888888888800000888888888880888888888888000000000000000000000000000000000000000000000000000000000000000000000
80800000000080000080000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
80080000000800000800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
80008800008000000800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
80000088880000008000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
88000000000000880000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
80888888888888000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__gff__
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000303030101030300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__map__
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
4040404040404040404040404040404000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
4041414141414040404041414140404000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
4041404141414141414541414140404000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
4041404141414040404040414140404000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
40414042414a4040404040414141414000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
4041404040404040404a4b414141414000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
4041404047414141414b41414141414000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
4041404047414141414141414141414000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
4041404040404040404040404040414000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
4041404341414040404040404040414000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
4041404141414040404040404040414000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
4046404141414541414141414145414000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
4040404040404040404040404040404000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
4040404040404040404040404040404000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
4040404040404040404040404040404000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
